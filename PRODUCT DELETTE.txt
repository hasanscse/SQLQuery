


ALTER proc [dbo].[FSP_PRODUCT_D]

@PRODUCT_CODE varchar (50),
@COMPANY_ID VARCHAR (10),
@BRANCH_ID VARCHAR (10)
AS

DECLARE @TOTAL_STOCK_AMOUNT DECIMAL(18,2)
SET @TOTAL_STOCK_AMOUNT=(SELECT TOTAL_STOCK_AMOUNT FROM PRODUCT 
WHERE PRODUCT_CODE=@PRODUCT_CODE AND @BRANCH_ID=@BRANCH_ID AND  COMPANY_ID=@COMPANY_ID
)

UPDATE ACCOUNTS
   SET 
      ACCOUNTS_BALANCE =ACCOUNTS_BALANCE-@TOTAL_STOCK_AMOUNT,
      OPENING_BALANCE=OPENING_BALANCE-@TOTAL_STOCK_AMOUNT ,
      COMPANY_ID=@COMPANY_ID     
   WHERE ACCOUNTS_CODE='9019012901901200040001' AND COMPANY_ID=@COMPANY_ID AND BRANCH_ID=@BRANCH_ID;

DELETE from  PRODUCT 
 WHERE  PRODUCT_CODE=@PRODUCT_CODE AND COMPANY_ID=@COMPANY_ID AND BRANCH_ID=@BRANCH_ID


