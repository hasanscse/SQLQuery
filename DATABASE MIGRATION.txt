USE [INVENTORY_MASTER]
GO
/****** Object:  StoredProcedure [dbo].[DATA_BASE_MIGRATION]    Script Date: 03/02/2020 22:02:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author      : <Billal>
-- Create date : <27.09.2014>
-- Description : <purchase return process>
-- =============================================
-- Modification Author      : <Billal>
-- Modification date		:04-OCT-2019
-- Modification Description : TOTAL_AMOUNT TO TOTAL_RETURN_AMOUNT
-- =============================================
/*

RESTORE CLIENT DATABASE INTO -- IM_OLD
THEN RESTORE LATEST SHOP_MANAGEMENT_DEV DATABASE INTO INVENTORY_MASTER
THEN EXECUTE FOLLOWING PROCIDURE


EXEC [DATA_BASE_MIGRATION]

exec RESET_DATA 'BILLAL','',''

*/
ALTER PROC  [dbo].[DATA_BASE_MIGRATION]


AS

---1
DELETE FROM INVENTORY_MASTER.[dbo].PRODUCT
DELETE FROM INVENTORY_MASTER.dbo.PRODUCT_SERIAL


---2
DELETE FROM INVENTORY_MASTER.[dbo].EXPENSE
DELETE FROM INVENTORY_MASTER.[dbo].BUYER_SUPPLIER_INFO
DELETE FROM INVENTORY_MASTER.[dbo].[ACCOUNTS]
DELETE FROM INVENTORY_MASTER.dbo.ACCOUNT_SUBSIDIARY
DELETE FROM INVENTORY_MASTER.dbo.CONTROL_ACCOUNT
DELETE FROM INVENTORY_MASTER.dbo.ACCOUNT_GROUP
DELETE FROM INVENTORY_MASTER.dbo.ACCOUNT_LEDGER
---3
DELETE FROM INVENTORY_MASTER.[dbo].PRODUCT_SUBCATEGORY
DELETE FROM INVENTORY_MASTER.[dbo].PRODUCT_CATEGORY
DELETE FROM INVENTORY_MASTER.[dbo].PRODUCT_BRAND
DELETE FROM INVENTORY_MASTER.[dbo].PRODUCT_UNIT_TYPES
DELETE FROM INVENTORY_MASTER.[dbo].SALES_OTHER_INFO
DELETE FROM INVENTORY_MASTER.[dbo].USER_PROFILE
DELETE FROM INVENTORY_MASTER.[dbo].USER_LOGIN_HISTORY


DELETE FROM INVENTORY_MASTER.dbo.BANK
--DELETE FROM INVENTORY_MASTER.dbo.BRANCH
DELETE FROM INVENTORY_MASTER.dbo.COLLECTION
DELETE FROM INVENTORY_MASTER.dbo.COLLECTION_EDIT


DELETE FROM INVENTORY_MASTER.dbo.PURCHASED_PRODUCT_SERIAL
DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.PURCHASE


DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_REQUISITION_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_REQUISITION


DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_RETURN_DETAILS_SERIAL
DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_RETURN_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.PURCHASE_RETURN


DELETE FROM INVENTORY_MASTER.dbo.SALES_PRODUCT_SERIAL_CANCEL
DELETE FROM INVENTORY_MASTER.dbo.SALES_OTHER_INFO
DELETE FROM INVENTORY_MASTER.dbo.SALES_PRODUCT_SERIAL
DELETE FROM INVENTORY_MASTER.dbo.SALES_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.SALES


DELETE FROM INVENTORY_MASTER.dbo.SALES_RETURN_DETAILS_SERIAL
DELETE FROM INVENTORY_MASTER.dbo.SALES_RETURN_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.SALES_RETURN


DELETE FROM INVENTORY_MASTER.dbo.SALES_OTHER_INFO_EDIT
DELETE FROM INVENTORY_MASTER.dbo.SALES_PRODUCT_SERIAL_EDIT
DELETE FROM INVENTORY_MASTER.dbo.SALES_DETAILS_EDIT
DELETE FROM INVENTORY_MASTER.dbo.SALES_EDIT


DELETE FROM INVENTORY_MASTER.dbo.STOCK_TRANSFER_REQUEST_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.STOCK_TRANSFER_REQUEST


DELETE FROM INVENTORY_MASTER.dbo.STOCK_TRANSFER_DETAILS_SERIAL
DELETE FROM INVENTORY_MASTER.dbo.STOCK_TRANSFER_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.STOCK_TRANSFER


DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT_SETUP_DETAILS_HIST
DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT_SETUP_DETAILS
DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT_SETUP_HIST
DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT_SETUP


DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT_DETAILS
DELETE FROM INVENTORY_MASTER.PRODUCTION.GENERATION_OF_PRODUCT


DELETE FROM INVENTORY_MASTER.INVENTORY.LOCATION
DELETE FROM INVENTORY_MASTER.INVENTORY.PRODUCT_COST_HISTORY
DELETE FROM INVENTORY_MASTER.INVENTORY.PRODUCT_INVENTORY




DELETE FROM INVENTORY_MASTER.dbo.PAYMENT


DELETE FROM INVENTORY_MASTER.dbo.DS_FEATURE_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.DS_FEATURE
DELETE FROM INVENTORY_MASTER.dbo.DS_SERIAL_GEN

DELETE FROM INVENTORY_MASTER.dbo.PROFESSION

DELETE FROM INVENTORY_MASTER.dbo.INVOICE_NOTES


DELETE FROM INVENTORY_MASTER.dbo.EMPLOYEE_SALARY
DELETE FROM INVENTORY_MASTER.dbo.EMPLOYEE





DELETE FROM INVENTORY_MASTER.dbo.COUNTRY
DELETE FROM INVENTORY_MASTER.dbo.DESIGNATION
DELETE FROM INVENTORY_MASTER.dbo.DISTRICT
DELETE FROM INVENTORY_MASTER.dbo.ZONE

DELETE FROM INVENTORY_MASTER.dbo.DS_FEATURE_DETAILS
DELETE FROM INVENTORY_MASTER.dbo.DS_FEATURE

DELETE FROM INVENTORY_MASTER.dbo.BRANCH
DELETE FROM INVENTORY_MASTER.dbo.COMPANY


--------------------------------------


insert into INVENTORY_MASTER.[dbo].[COMPANY]
SELECT [COMPANY_ID]
      ,[COMPANY_INITIAL]
      ,[COMPANY_NAME]
      ,[ADDRESS]
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[URL]
      ,[IMAGE_FILE]
  FROM [IM_OLD].[dbo].[COMPANY]

insert into INVENTORY_MASTER.[dbo].[BRANCH]
SELECT [BRANCH_ID]
      ,[BRANCH_NAME]
      ,[BRANCH_INITIAL]
      ,[BRANCH_ADDRESS]
      ,[BRANCH_TELEPHONE]
      ,[BRANCH_MOBILE]
      ,[BRANCH_EMAIL]
      ,[BRANCH_STATUS]
      ,[COMPANY_ID]
      ,[HO_FLAG]
      ,[WARE_HOUSE_FLAG]
  FROM [IM_OLD].[dbo].[BRANCH]


insert into INVENTORY_MASTER.[dbo].[COUNTRY]
SELECT [COUNTRY_ID]
      ,[COUNTRY_NAME]
      ,[CALLING_CODE]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM [IM_OLD].[dbo].[COUNTRY]

--insert into INVENTORY_MASTER.[dbo].[DESIGNATION]
--SELECT [DESIGNATION_ID]
--      ,[DESIGNATION_NAME]
--  FROM [IM_OLD].[dbo].[DESIGNATION]
  
  insert into INVENTORY_MASTER.[dbo].[DISTRICT]
  SELECT [DISTRICT_ID]
      ,[DISTRICT_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM [IM_OLD].[dbo].[DISTRICT]
  
insert into INVENTORY_MASTER.[dbo].[ZONE]
SELECT [ZONE_ID]
      ,[ZONE_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM [IM_OLD].[dbo].[ZONE]
  
  
  
  
--update INVENTORY_MASTER.[dbo].[COMPANY] 
--set COMPANY_INITIAL=b.COMPANY_INITIAL,
--	COMPANY_NAME=b.COMPANY_NAME,
--	ADDRESS=b.ADDRESS,
--	PHONE=b.PHONE,
--	FAX=b.FAX,
--	EMAIL=b.EMAIL,
--    URL=b.URL
--from INVENTORY_MASTER.[dbo].[COMPANY] a
--inner join IM_OLD.[dbo].[COMPANY] b
--on a.COMPANY_ID=b.COMPANY_ID


insert into INVENTORY_MASTER.[dbo].[ACCOUNT_GROUP]

SELECT [ACCOUNT_GROUP_CODE]
      ,[ACCOUNT_GROUP_NAME]
      ,[ACCOUNT_GROUP_TYPE]
      ,[COMPANY_ID]
      ,[MANDATORY]
  FROM [IM_OLD].[dbo].[ACCOUNT_GROUP] 
  
  insert into INVENTORY_MASTER.[dbo].[CONTROL_ACCOUNT]
  SELECT [CONTROL_CODE]
      ,[CONTROL_NAME]
      ,[ACCOUNT_GROUP_CODE]
      ,[COMPANY_ID]
      ,[MANDATORY]
  FROM [IM_OLD].[dbo].[CONTROL_ACCOUNT]
  
  insert into INVENTORY_MASTER.[dbo].[ACCOUNT_SUBSIDIARY]
  SELECT [SUBSIDIARY_CODE]
      ,[CONTROL_CODE]
      ,[SUBSIDIARY_NAME]
      ,[COMPANY_ID]
      ,[MANDATORY]
  FROM [IM_OLD].[dbo].[ACCOUNT_SUBSIDIARY]
     

insert into INVENTORY_MASTER.[dbo].[ACCOUNTS]
SELECT [GROUP_CODE]
      ,[CONTROL_CODE]
      ,[SUBSIDIARY_CODE]
      ,[ACCOUNTS_CODE]
      ,[DESCRIPTION]
      ,[OPENING_DATE]
      ,[OPENING_TIME]
      ,[OPENING_BALANCE]
      ,[BALANCE_TYPE]
      ,[STATEMENT_TYPE]
      ,[NOTES]
      ,[MANDATORY]
      ,[ACCOUNTS_BALANCE]
      ,[CASH_BANK]
      ,[ACCOUNT_TYPE]
      ,[IS_ACTIVE]
      ,[OPENING_BALANCE_FLAG]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM [IM_OLD].[dbo].[ACCOUNTS]


insert into INVENTORY_MASTER.[dbo].[BUYER_SUPPLIER_INFO]
SELECT [BUYER_SUPPLIER_ID]
      ,[BUYER_SUPPLIER_NAME]
      ,[COMPANY_NAME]
      ,[ADDRESS]
      ,[ZONE_ID]
      ,[COUNTRY_ID]
      ,[DISTRICT_ID]
      ,[PROFESSION_ID]
      ,[PHONE]
      ,[OPENNING_DATE]
      ,[OPENNING_BALANCE]
      ,[COMPANY_ID]
      ,[IS_ACTIVE]
      ,[POST_CODE]
      ,[BUYER_SUPPLIER_FLAG]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[BS_ACCOUNT_BALANCE]
      ,[MANDATORY]
      ,[DISCOUNT]
      ,[BRANCH_ID]
      ,[BOOTH_ID]
      ,[MEDICINE_SUPPLIER_FLAG]
      ,''
      ,''
      ,''
      ,''
      ,''
      ,0
      ,0
      ,0,
      0,'','',0,0
  FROM IM_OLD.[dbo].[BUYER_SUPPLIER_INFO]
 


insert into INVENTORY_MASTER.[dbo].[BANK]

SELECT --[BANK_ID]
       [ACCOUNTS_CODE]
      ,[BANK_NAME]
      ,[BANK_ADDRESS]
      ,[BANK_COUNTRY]
      ,[BANK_FAX]
      ,[BANK_PHONE]
      ,[BANK_EMAIL]
      ,[BANK_ACCOUNT_TYPE]
      ,[BANK_ACCOUNT_NAME]
      ,[BANK_CREDIT_CARD]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[BANK]
  
  insert into INVENTORY_MASTER.[dbo].[DS_SERIAL_GEN]
  SELECT --- [ROW_ID]
       [TABLE_NAME]
      ,[DESCRIPTION]
      ,[MAX_SERIAL_NO]
      ,[SERIAL_YEAR]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[DS_SERIAL_GEN]
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT_BRAND]
  SELECT [BRAND_ID]
      ,[BRAND_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM IM_OLD.[dbo].[PRODUCT_BRAND]
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT_CATEGORY]
  SELECT [CATEGORY_ID]
      ,[CATEGORY_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM IM_OLD.[dbo].[PRODUCT_CATEGORY]
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT_SUBCATEGORY]
  SELECT [SUBCATEGORY_ID]
      ,[SUBCATEGORY_NAME]
      ,[CATEGORY_ID]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM IM_OLD.[dbo].[PRODUCT_SUBCATEGORY]
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT_UNIT_TYPES]
  SELECT [UNIT_ID]
      ,[UNIT_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM IM_OLD.[dbo].[PRODUCT_UNIT_TYPES]
  
  
  
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT]
  SELECT [PRODUCT_CODE]
      ,[PRODUCT_NAME]
      ,[PRODUCT_DESCRIPTION]
      ,[SUBCATEGORY_ID]
      ,[BRAND_ID]
      ,[CATEGORY_ID]
      ,[UNIT_ID]
      ,[UNIT_ID_SECONDARY]
      ,[SERIAL_AVAILABLE]
      ,[PURCHASE_PRICE]
      ,[SALES_PRICE]
      ,[WARRANTY_DAYS]
      ,[PRODUCT_STATUS]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[STOCK_QUANTITY]
      ,[REORDER_LEVEL]
      ,[OPENING_DATE]
      ,[OPENING_STOCK_QUANTITY]
      ,[OPENING_STOCK_AMOUNT]
      ,[PURCHASED_PRICE]
      ,[TOTAL_STOCK_AMOUNT]
      ,[SALES_VAT]
      ,[COMPANY_ID]
      ,[RAW_MATERIALS_STATUS]
      ,[DISCOUNT]
      ,0
      ,[BRANCH_ID]
      ,[BUYER_SUPPLIER_ID]
      ,''
      ,''
      ,''
      ,''
      ,''
      ,0
      ,0
      ,0
      ,0
  FROM IM_OLD.[dbo].[PRODUCT]
  
  
  insert into INVENTORY_MASTER.[dbo].[PRODUCT_SERIAL]
  SELECT [PRODUCT_SERIAL]
      ,[PRODUCT_CODE]
      ,[SYS_GEN_FLAG]
      ,[SALES_STATUS]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
      ,0
      ,0
  FROM IM_OLD.[dbo].[PRODUCT_SERIAL]
  
  
  
  insert into INVENTORY_MASTER.[dbo].[PURCHASE]
 SELECT [PURCHASE_INVOICE_NO]
      ,[SUPPLIER_ID]
      ,[TOTAL_AMOUNT]
      ,[PAID_AMOUNT]
      ,[COMPANY_ID]
      ,[PREVIOUS_DUES]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[CANCELLED_BY]
      ,[CANCELLED_DT]
      ,[CANCELLED_REASON]
      ,[REMARKS]
      ,[CANCEL_FLAG]
      ,[RETURN_BY]
      ,[RETURN_FLAG]
      ,''--[EDIT_FLAG]
      ,''--[EDIT_BY]
      ,''--[EDIT_DT]
      ,''--[SET_NO]
      ,[BRANCH_ID]
      ,[PURCHASE_REQUISITION_NO]
  FROM IM_OLD.[dbo].[PURCHASE]
  
  insert into INVENTORY_MASTER.[dbo].[PURCHASE_DETAILS]
  SELECT --[PURCHASE_DETAILS_ID],
      [PURCHASE_INVOICE_NO]
      ,[PRODUCT_CODE]
      ,[UNIT_ID]
      ,[QUANTITY]
      ,[TOTAL_PURCHASED_PRICE]
      ,[SERIAL_AVAILABLE]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[PURCHASE_DETAILS]
  
  insert into INVENTORY_MASTER.[dbo].[PURCHASED_PRODUCT_SERIAL]
  SELECT-- [PURCHASED_PRODUCT_SERIAL_ID]
      --,
      [PURCHASE_INVOICE_NO]
      ,[PRODUCT_SERIAL]
      ,[PRODUCT_CODE]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
      ,0
  FROM IM_OLD.[dbo].[PURCHASED_PRODUCT_SERIAL]
  
  
  
  insert into INVENTORY_MASTER.[dbo].[SALES]
  SELECT [SALES_INVOICE_NO]
      ,[TOTAL_AMOUNT]
      ,[TOTAL_VAT]
      ,[PREVIOUS_DUES]
      ,[TOTAL_DISCOUNT]
      ,[COLLECTED_AMOUNT]
      ,[BUYER_SUPPLIER_ID]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[CANCEL_FLAG]
      ,[CANCELLED_BY]
      ,[CANCELLED_DT]
      ,[RETURN_FLAG]
      ,[RETURN_BY]
      ,[RETURN_DATE]
      ,[REMARKS]
      ,[COMPANY_ID]
      ,[CANCELLED_REASON]
      ,[EDIT_FLAG]
      ,[EDIT_BY]
      ,[EDIT_DT]
      ,''
      ,[BRANCH_ID]
      ,[EMI_FLAG]
      ,[MEDICINE_SELL_NO]
      ,'9019012901901200020001'
      ,0
      ,''
      ,''
      ,0
      ,0
      ,0
      ,GETDATE()
      ,0
  FROM IM_OLD.[dbo].[SALES]
  
  insert into INVENTORY_MASTER.[dbo].[SALES_DETAILS]
  SELECT --[SALES_DETAILS_ID],      
      [SALES_INVOICE_NO]
      ,[PRODUCT_CODE]
      ,[UNIT_ID]
      ,[QUANTITY]
      ,[SALES_PRICE]
      ,[SERIAL_AVAILABLE]
      ,[SALES_VAT]
      ,[SALES_VAT_AMOUNT_TOTAL]
      ,[PURCHASE_PRICE]
      ,[COMPANY_ID]
      ,''
      ,[BRANCH_ID]
      ,''
  FROM IM_OLD.[dbo].[SALES_DETAILS]
  
  insert into INVENTORY_MASTER.[dbo].[SALES_OTHER_INFO]
  SELECT [SALES_INVOICE_NO]
  ,''
  ,0
      ,[TOTAL_AMOUNT]
      ,[GIVEN_AMOUNT]
      ,[CHANGE_AMOUNT]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[SALES_OTHER_INFO]
  
  
  insert into INVENTORY_MASTER.[dbo].[SALES_PRODUCT_SERIAL]
  SELECT --[SALES_PRODUCT_SERIAL_ID]
     -- ,
      [SALES_INVOICE_NO]
      ,[PRODUCT_SERIAL]
      ,[PRODUCT_CODE]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
      ,[SET_NO]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[SALES_PRODUCT_SERIAL]
  
  
  
  insert into INVENTORY_MASTER.[dbo].[SALES_OTHER_INFO_EDIT]
  SELECT [SALES_INVOICE_NO]
      ,[TOTAL_AMOUNT]
      ,[GIVEN_AMOUNT]
      ,[CHANGE_AMOUNT]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[SALES_OTHER_INFO_EDIT]
  
  
  insert into INVENTORY_MASTER.[dbo].[SALES_RETURN]
  SELECT [SALES_RETURN_NO]
      ,[SALES_INVOICE_NO]
      ,''
      ,[TOTAL_AMOUNT]
      ,[TOTAL_RETURN_AMOUNT]
      ,[PREVIOUS_DUES]
      ,[BUYER_SUPPLIER_ID]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[CANCEL_FLAG]
      ,[CANCELLED_BY]
      ,[CANCELLED_DT]
      ,[CANCELLED_REASON]
      ,[REMARKS]
      ,[EDIT_FLAG]
      ,[EDIT_BY]
      ,[EDIT_DT]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
      ,[TOTAL_VAT_RETURN]
  FROM IM_OLD.[dbo].[SALES_RETURN]
  
  insert into INVENTORY_MASTER.[dbo].[SALES_RETURN_DETAILS]
  SELECT 
      [SALES_RETURN_NO]
      ,[PRODUCT_CODE]
      ,[SALES_INVOICE_NO]
      ,[UNIT_ID]
      ,[QUANTITY]
      ,[QUANTITY_OLD]
      ,[RETURN_PRICE]
      ,[SALES_PRICE]
      ,[SERIAL_AVAILABLE]
      ,[SALES_VAT]
      ,[SALES_VAT_AMOUNT_TOTAL]
      ,[PURCHASE_PRICE]
      ,[COMPANY_ID]
      ,[SET_NO]
      ,[BRANCH_ID]
      ,0
  FROM IM_OLD.[dbo].[SALES_RETURN_DETAILS]
  
insert into INVENTORY_MASTER.[dbo].[COLLECTION]
SELECT [COLLECTION_NO]
      ,[COLLECTED_AMOUNT]
      ,[PREVIOUS_DUE]
      ,[NARRATION]
      ,[COLLECTION_DATE]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[COMPANY_ID]
      ,[BUYER_SUPPLIER_ID]
      ,[ACCOUNTS_CODE]
      ,[SALES_INVOICE_NO]
      ,[COLLECTION_TYPE]
      ,[COLLECTION_CANCEL]
      ,[CANCELLED_BY]
      ,[CANCELLED_DT]
      ,[CANCEL_REASON]
      ,''--[EDIT_FLAG]
      ,''--[EDIT_BY]
      ,''--[EDIT_DT]
      ,''--[SET_NO]
      ,[BRANCH_ID]
  FROM [IM_OLD].[dbo].[COLLECTION]
  
  insert into INVENTORY_MASTER.[dbo].[PAYMENT]
  SELECT [PAYMENT_NO]
      ,[PAID_AMOUNT]
      ,[PREVIOUS_DUE]
      ,[NARRATION]
      ,[PAYMENT_DATE]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[COMPANY_ID]
      ,[BUYER_SUPPLIER_ID]
      ,[ACCOUNTS_CODE]
      ,[PURCHASE_INVOICE_NO]
      ,[PAYMENT_TYPE]
      ,[PAYMENT_CANCEL]
      ,[CANCEL_REASON]
      ,[CANCELLED_BY]
      ,[CANCELLED_DT]
      ,''--[EDIT_FLAG]
      ,''--[EDIT_BY]
      ,''--[EDIT_DT]
      ,''--[SET_NO]
      ,[BRANCH_ID]
  FROM [IM_OLD].[dbo].[PAYMENT]

insert into INVENTORY_MASTER.[dbo].[ACCOUNT_LEDGER]

SELECT [VOUCHER_NO]
      ,[TRACER_NO]
      ,[PURCHASE_INVOICE_NO]
      ,[SALES_INVOICE_NO]
      ,[COLLECTION_NO]
      ,[PAYMENT_NO]
      ,[STOCK_TRANSFER_INVOICE_NO]
      ,[ACCOUNT_ID]
      ,[BUYER_SUPPLIER_ID]
      ,[DATE]
      ,[TRANSACTION_TYPE]
      ,[LEDGER_DEBIT]
      ,[LEDGER_CREDIT]
      ,[NEW_AMOUNT]
      ,[COMPANY_ID]
      ,[MAKE_BY]
      ,[MAKE_DATE]
      ,[NOTE]
      ,[SYSTEM_GENERATION_FLAG]
      ,[AUTHORIZE_STATUS]
      ,[ORIGINAL_VOUCHER_NO]
      ,[ORIGINAL_TRACER_NO]
      ,[BRANCH_ID]
  FROM [IM_OLD].[dbo].[ACCOUNT_LEDGER]
  
  
 

insert into INVENTORY_MASTER.[dbo].[USER_PROFILE]
 SELECT [USER_ID]
      ,[USER_NAME]
      ,[PASSWORD]
      ,[PASSWORD_FORMAT]
      ,[PASSWORD_SALT]
      ,[MOBILE_PIN]
      ,[EMAIL]
      ,[LOWERED_EMAIL]
      ,[PASSWORD_QUESTION]
      ,[PASSWORD_ANSWER]
      ,[IS_ACTIVE]
      ,[IS_LOCKED_OUT]
      ,[LAST_LOGIN_DATE]
      ,[LAST_PASSWORD_CHANGED_DATE]
      ,[LAST_LOCKOUT_DATE]
      ,[FAILED_PASSWORD_ATTEMPT_COUNT]
      ,[FAILED_PASSWORD_ATTEMPT_WINDOW_START]
      ,[FAILED_PASSWORD_ANSWER_ATTEMPT_COUNT]
      ,[FAILED_PASSWORD_ANSWER_ATTEMPT_WINDOW_START]
      ,[TERMINAL_IP_ADDRESS]
      ,[APPLICATION_ID]
      ,[COMMENT]
      ,[COMPANY_ID]
      ,[MAKE_BY]
      ,[MAKE_DT]
      ,[BRANCH_ID]
      ,''
      ,1
      ,1
      ,1
      ,1
      ,1
  FROM IM_OLD.[dbo].[USER_PROFILE] 
  --where USER_ID!='king' -- and COMPANY_ID!=1
  
 
insert into INVENTORY_MASTER.[dbo].[USER_LOGIN_HISTORY] 
  SELECT [USER_ID]
      ,[LOGIN_TIME]
      ,[TERMINAL_IP_ADDRESS]
      ,[LOGOUT_TIME]
      ,[SESSION_ID]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM IM_OLD.[dbo].[USER_LOGIN_HISTORY]
 
 
 
  
  delete SM_MENU_ASSIGN
  where COMPANY_ID!=1;
  
  delete SM_MENU_ASSIGN
  where user_id!='king';  
   
   
insert into INVENTORY_MASTER.[dbo].[SM_MENU_ASSIGN] 
  SELECT --[ROWID],
      [MENU_ID]
      ,[USER_ID]
      ,[FUNCTION_ID]
      ,[ASSIGN_VALUE]
      ,1
      ,1
  FROM IM_OLD.[dbo].[SM_MENU_ASSIGN]
  where user_id!='king';  

  insert into INVENTORY_MASTER.[dbo].[DS_FEATURE]
  SELECT [FEATURE_ID]
      ,[FEATURE_VALUE]
      ,[FEATURE_DESCRIPTION]
      ,[COMPANY_ID]
      ,[BRANCH_ID]
  FROM [IM_OLD].[dbo].[DS_FEATURE]
  
  insert into INVENTORY_MASTER.[dbo].[DS_FEATURE_DETAILS]
  SELECT [FEATURE_ID]
      ,[FEATURE_VALUE]
      ,[FEATURE_DESCRIPTION]
      ,[USER_ID]
      ,[COMPANY_ID]
      ,[MIDICINE_MODULE_FLAG]
      ,[PRODUCTION_MODULE_FLAG]
      ,[WAREHOUSE_MODULE_FLAG]
  FROM [IM_OLD].[dbo].[DS_FEATURE_DETAILS]
  
  
  
INSERT INTO INVENTORY_MASTER.[dbo].[INVOICE_NOTES]
  SELECT    [INVOICE_NOTES_ID]
           ,[INVOICE_NOTES_DETAILS]
           ,[IS_ACTIVE]
           ,[COMPANY_ID]

  FROM [IM_OLD].[dbo].[INVOICE_NOTES]
  
  
  INSERT INTO INVENTORY_MASTER.[dbo].[PROFESSION]
  SELECT [PROFESSION_ID]
      ,[PROFESSION_NAME]
      ,[IS_ACTIVE]
      ,[COMPANY_ID]
  FROM [IM_OLD].[dbo].[PROFESSION]

------------------------------------



--DELETE FROM [dbo].DISTRICT
--      WHERE COMPANY_ID !=1
      



--DELETE FROM [dbo].BANK
--      WHERE COMPANY_ID !=1


--DELETE FROM [dbo].PROFESSION
--      WHERE COMPANY_ID !=1


--DELETE FROM [dbo].PRODUCT_UNIT_TYPES
--      WHERE COMPANY_ID !=1

--DELETE FROM [dbo].ZONE
--      WHERE COMPANY_ID !=1

--DELETE FROM [dbo].COUNTRY
--      WHERE COMPANY_ID !=1
      
      
--DELETE FROM [dbo].[ACCOUNTS]
--      WHERE COMPANY_ID !=1
 
-- DELETE FROM [dbo].ACCOUNT_SUBSIDIARY
--      WHERE COMPANY_ID !=1
 
-- DELETE FROM [dbo].CONTROL_ACCOUNT
--      WHERE COMPANY_ID !=1



-- DELETE FROM [dbo].DS_FEATURE
--      WHERE COMPANY_ID !=1
 
--      DELETE FROM [dbo].[BUYER_SUPPLIER_INFO]
--      WHERE COMPANY_ID !=1  
      
--   DELETE FROM [dbo].BRANCH
--      WHERE COMPANY_ID !=1    


--DELETE FROM [dbo].INVOICE_NOTES
--      WHERE COMPANY_ID !=1  
  
--   DELETE FROM [dbo].COMPANY
--      WHERE COMPANY_ID !=1  
      
      
   

 